<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin Secret Control Room</title>
<style>
body {
  font-family: "Patrick Hand", cursive;
  background: linear-gradient(#222, #444);
  color: #fff;
  padding: 20px;
}
h1 { text-align:center; color:#ff9ecb; }
button {
  font-family: inherit;
  padding: 5px 10px;
  border-radius: 8px;
  border: none;
  cursor: pointer;
}
button:hover { opacity: 0.8; }
.player-box {
  background: #333;
  padding: 10px;
  margin-bottom: 10px;
  border-radius: 12px;
}
#historyBox {
  background: #444;
  padding: 10px;
  margin-top: 15px;
  border-radius: 12px;
  max-height: 300px;
  overflow-y: auto;
}
</style>
</head>
<body>

<h1>üõ†Ô∏è Admin Control Room</h1>

<div id="playerList"></div>

<div id="historyBox"></div>

<script>
// ---------- LOAD & SAVE ----------
let players = JSON.parse(localStorage.getItem("gachaPlayers") || "[]");

function savePlayers() {
  localStorage.setItem("gachaPlayers", JSON.stringify(players));
}

// ---------- RENDER PLAYERS ----------
function renderPlayers() {
  const container = document.getElementById("playerList");
  container.innerHTML = "";
  
  if(players.length===0){
    container.innerHTML = "<p>No players found.</p>";
    return;
  }

  players.forEach((p, index) => {
    const div = document.createElement("div");
    div.className = "player-box";
    div.innerHTML = `
      <strong>${p.name}</strong> ‚Äî ü™ô ${p.coins} ‚Äî Stage: ${p.stage || 'basic'}
      <br>
      <button onclick="viewHistory(${index})">View History</button>
      <button onclick="deletePlayer(${index})">Delete Player</button>
    `;
    container.appendChild(div);
  });
}

// ---------- VIEW HISTORY ----------
function viewHistory(playerIndex) {
  const historyBox = document.getElementById("historyBox");
  const player = players[playerIndex];

  if(player.history.length===0){
    historyBox.innerHTML = `<h3>${player.name}'s History</h3><p>No items pulled yet.</p>`;
    return;
  }

  historyBox.innerHTML = `
    <h3>${player.name}'s History</h3>
    ${player.history.map((item, i) => `
      ‚Ä¢ ${item.name} (${item.rarity})
      <button onclick="deleteItem(${playerIndex}, ${i})">‚ùå</button>
      <br>
    `).join("")}
  `;
}

// ---------- DELETE ONE ITEM ----------
function deleteItem(playerIndex, itemIndex) {
  if(!confirm("Delete this item?")) return;
  players[playerIndex].history.splice(itemIndex, 1);
  savePlayers();
  viewHistory(playerIndex);
}

// ---------- DELETE PLAYER ----------
function deletePlayer(index) {
  if(!confirm("Delete this player forever?")) return;
  players.splice(index, 1);
  savePlayers();
  renderPlayers();
  document.getElementById("historyBox").innerHTML = "";
}

// ---------- INIT ----------
renderPlayers();
</script>

</body>
</html>
