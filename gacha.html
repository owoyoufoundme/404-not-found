<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Gacha Room</title>
<link href="https://fonts.googleapis.com/css2?family=Patrick+Hand&display=swap" rel="stylesheet">
<style>
body {
  margin: 0;
  font-family: "Patrick Hand", cursive;
  background: linear-gradient(#ffe6f0, #fff);
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100vh;
}
.card {
  width: 400px;
  background: white;
  border-radius: 20px;
  padding: 30px;
  text-align: center;
  box-shadow: 0 10px 30px rgba(0,0,0,0.15);
}
input, button {
  font-family: inherit;
  padding: 10px;
  margin-top: 10px;
  border-radius: 10px;
}
input { width: 80%; border: 2px solid #ff9ecb; }
button { border: none; background: #ff9ecb; cursor: pointer; }
button:hover { background: #ff7fb5; }
.gacha-image { width: 100%; max-height: 180px; object-fit: cover; border-radius: 12px; margin-bottom: 15px; }
.hidden { display: none; }
#coinsDisplay { font-size: 18px; margin-bottom: 10px; }
</style>
</head>
<body>

<div class="card">

  <!-- NAME SETUP -->
  <div id="nameSetup">
    <h1>Welcome â™¡</h1>
    <p>Enter your name:</p>
    <input id="playerNameInput" placeholder="Your name">
    <br>
    <button onclick="registerName()">Enter</button>
  </div>

  <!-- GACHA UI -->
  <div id="gachaUI" class="hidden">
    <div id="coinsDisplay">ðŸª™ 0</div>
    <img src="www.png" alt="Gacha Banner" class="gacha-image">
    <button onclick="rollGacha()">Pull Gacha</button>
    <div id="history"></div>
  </div>

</div>

<script>
const GACHA_COST = 10;
let player = { name: "", coins: 0, history: [], usedCodes: [] };

// --- LOAD PLAYER ---
function loadPlayer() {
  const savedName = localStorage.getItem("currentPlayerName");
  const allPlayers = JSON.parse(localStorage.getItem("gachaPlayers") || "[]");
  if(savedName) {
    const savedPlayer = allPlayers.find(p=>p.name===savedName);
    if(savedPlayer) {
      player = savedPlayer;
      showGacha();
      return;
    }
  }
  document.getElementById("nameSetup").classList.remove("hidden");
}

// --- SAVE PLAYER ---
function savePlayer() {
  let allPlayers = JSON.parse(localStorage.getItem("gachaPlayers") || "[]");
  const idx = allPlayers.findIndex(p=>p.name===player.name);
  if(idx>-1) allPlayers[idx]=player;
  else allPlayers.push(player);
  localStorage.setItem("gachaPlayers", JSON.stringify(allPlayers));
  localStorage.setItem("currentPlayerName", player.name);
  updateUI();
}

// --- REGISTER NAME ---
function registerName() {
  const name = document.getElementById("playerNameInput").value.trim();
  if(!name) return alert("Enter a valid name!");
  const allPlayers = JSON.parse(localStorage.getItem("gachaPlayers") || "[]");
  const existing = allPlayers.find(p=>p.name===name);
  if(existing) player = existing;
  else player = { name, coins: 50, history: [], usedCodes: [] };
  savePlayer();
  showGacha();
}

// --- SHOW GACHA ---
function showGacha() {
  document.getElementById("nameSetup").classList.add("hidden");
  document.getElementById("gachaUI").classList.remove("hidden");
  updateUI();
}

// --- UPDATE UI ---
function updateUI() {
  document.getElementById("coinsDisplay").innerText = `ðŸª™ ${player.coins}`;
  document.getElementById("history").innerHTML = player.history.map(h=>`â€¢ ${h}`).join("<br>");
}

// --- GACHA ROLL ---
const pool = ["Health Potion", "Speed Potion", "Golden Ticket"];
function rollGacha() {
  if(player.coins < GACHA_COST) return alert("Not enough coins!");
  player.coins -= GACHA_COST;
  const reward = pool[Math.floor(Math.random()*pool.length)];
  player.history.unshift(reward);
  savePlayer();
  alert(`You pulled: ${reward}`);
}

loadPlayer();
</script>

</body>
</html>
